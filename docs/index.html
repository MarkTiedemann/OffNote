
<title>.note</title>
<meta name='viewport' content='width=device-width, initial-scale=1'>

<!-- Favicons generated by http://realfavicongenerator.net/ -->
<link rel="apple-touch-icon" sizes="120x120" href="favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" href="favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="favicons/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="favicons/manifest.json">
<link rel="mask-icon" href="favicons/safari-pinned-tab.svg" color="#3a96dd">
<link rel="shortcut icon" href="favicons/favicon.ico">
<meta name="msapplication-config" content="favicons/browserconfig.xml">
<meta name="theme-color" content="#3a96dd">

<style>

body {
  margin: 0;
  padding: 0;
  display: flex;
  align-items: center;
  overflow-x: hidden;
}

textarea {
  width: 100%;
  min-height: 100%;

  margin: auto;
  padding: 33px 44px;

  font-family: 'Segoe UI';
  font-size: 22px;
  line-height: 22px;
  letter-spacing: 0.11px;

  border: none;
  outline: none;
  border-color: transparent;
  background-color: transparent;

  overflow: hidden;

  white-space: pre-wrap;
  overflow-wrap: break-word;
}

</style>

<textarea wrap='hard' spellcheck='false' autofocus>



** ✈️.note **



// Simple notepad that works in airplane-mode



</textarea>

<script>

// RESIZING

const textarea = document.querySelector('textarea')

const width = x => x <= 555 ? x : 555 + x / 11.11

const updateSize = () => {
  requestAnimationFrame(() => {
    const scrollTop  = window.pageYOffset || document.body.scrollTop
    textarea.style.width = width(window.innerWidth) + 'px'
    textarea.style.height = 'auto'
    textarea.style.height = textarea.scrollHeight
    window.scrollTo(0, scrollTop)
  })
}

updateSize()
window.onresize = updateSize

// TEXT

const ITEM = 'air.note-text'

const loadText = () => {
    const text = localStorage.getItem(ITEM)
    if (text !== null) textarea.value = text
}

const saveText = () =>
  requestIdleCallback(() =>
    localStorage.setItem(ITEM, textarea.value))

loadText()
textarea.oninput = () => {
    saveText()
    updateSize()
}

// SERVICE WORKER

if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    const DEV_ENV = location.href.startsWith('http://localhost:3000/')
    navigator.serviceWorker.register('service-worker.js', {
      scope: DEV_ENV ? '/' : '/air.note/'
    })
    .catch(e => DEV_ENV ? console.error('Failed to register:', e) : 0)
  })
}

</script>
